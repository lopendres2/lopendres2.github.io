<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mnaynamna</title>
  <link rel="stylesheet" href="itemone.css">
  <link rel="stylesheet" href="light.css" media="(prefers-color-scheme: light)">
  <link rel="stylesheet" href="dark.css" media="(prefers-color-scheme: dark)">
</head>

<body>
  <div class="container">
    <div class="slider" id="slider">
      <div class="slides" id="slides">
      </div>
    </div>
    <div class="dots" id="dotContainer"></div>
    <h1>Варежки</h1>
    <p class="title">Описание</p>
    <p class="description">
      Вязанные варежки — теплые и уютные аксессуары, созданные для защиты ваших рук от холода.
      Связаны с любовью из мягкой и приятной на ощупь пряжи, они станут надежными спутниками в
      холодное время года. Простые и элегантные, они подчеркнут ваш стиль и согреют в самые морозные дни.
    </p>
  </div>
  <script>
    const images = ['./img/перчатки.jpg', './img/топ.jpg', './img/шапки.jpg'];
    const slidesContainer = document.querySelector('.slides');
    const dotContainer = document.querySelector('#dotContainer');
    let currentSlide = 0;
    let startX;
    let isSwiping = true;
    

    function setSlide(index) {
      const offset = -index * 100 + '%';
      slidesContainer.style.transform = 'translateX(' + offset + ')';
      currentSlide = index;
      updateDots();
    }

    function nextSlide() {
      setSlide(currentSlide + 1);
    }

    function prevSlide() {
      setSlide(currentSlide - 1);
    }

    function updateDots() {
      dotContainer.innerHTML = '';
      for (let i = 0; i < images.length; i++) {
        const dot = document.createElement('div');
        dot.className = `dot ${i === currentSlide ? 'active' : ''}`;
        dot.onclick = () => setSlide(i);
        dotContainer.appendChild(dot);
      }
    }

    function handleTouchStart(event) {
      startX = event.touches[0].clientX;
      isSwiping = true;
    }

    function handleTouchMove(event) {
      if (!isSwiping) return;
      const diffX = event.touches[0].clientX - startX;
      slidesContainer.style.transition = 'transform 0s ease';
      slidesContainer.style.transform = 'translateX(' + (-currentSlide * 100 + diffX) + '%';
    }

    function handleTouchEnd(event) {
      if (!isSwiping) return;
      isSwiping = false;
      slidesContainer.style.transition = 'transform 0.5s ease';
      const threshold = 0.2;
      const distance = event.changedTouches[0].clientX - startX;

      if (Math.abs(distance) > window.innerWidth * threshold) {
        if (distance > 0) {
          prevSlide();
        } else {
          nextSlide();
        }
      } else {
        setSlide(currentSlide);
      }
    }

    function createSlides(){
      let frag = document.createDocumentFragment();
      images.forEach((el,i)=>{
        let slide = document.createElement('div');
        let img = document.createElement('img');
        slide.classList.add('slide');
        img.classList.add('img');
        img.setAttribute('src', el)
        img.setAttribute('alt', i)
        slide.appendChild(img)
        frag.appendChild(slide)
      })
      slidesContainer.appendChild(frag)
    }

    function initializeSlider() {
      createSlides();
      updateDots();
      slidesContainer.addEventListener('touchstart', handleTouchStart);
      slidesContainer.addEventListener('touchmove', handleTouchMove);
      slidesContainer.addEventListener('touchend', handleTouchEnd);

      // Дополнительные обработчики для восстановления слайдера после свайпа
      slidesContainer.addEventListener('transitionend', () => {
        slidesContainer.style.transition = 'none';
        slidesContainer.style.transform = 'translateX(' + (-currentSlide * 100) + '%)';
        setTimeout(() => {
          slidesContainer.style.transition = 'transform 0.5s ease';
        });
      });
    }

    initializeSlider();
  </script>
</body>

</html>
